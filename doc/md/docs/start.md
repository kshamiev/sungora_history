[main](/) ::
[quick start](/docs/start.html) ::
[reference](/docs/reference.html) ::
[tutorial](/docs/tutorial.html) ::
[api](/docs/api.html) ::
[sample](/sample) ::
[download](https://github.com/kshamiev/sungora)

# Быстрый старт
***

### Файловая структура пакетов
Пакет формируется из файлов разбитых по функциональному признаку. Пример:  
…/packagename/
- packagename.go

Основной файл пакета. Содержит основной функционал пакета. Возможно целиком состоит из одного такого файла.

- functionalname.go

Файл содержащий логически законченный программный код, реализующий конкретную прикладную задачу пакета.

- doc.go

Документация и примеры использования пакета.

Платформ зависимый программный код размещается в одноименных функциональных файлах с добавлением суффикса платформы (_windows, _darwin, _linux).  
В каждом платформа зависимом файле обязательно должен находиться один и тот же набор функций или методов.  
Также в пакете могут присутствовать файлы тестирования (_test)

Для исключения путаницы в одноименных файлах (контроллеров, моделей, типов):
- Файлы пакетов прикладных контроллеров заканчиваются заглавной буквой `C`
- Файлы пакетов прикладных моделей заканчиваются заглавной буквой `M`
- Файлы пакетов типов БД заканчиваются заглавной буквой `T`

### Файловая структура системы
- **app** / 				`Область приложения.`

	Модули приложения. Данные приложения.</br>
	Роутинг, Хеш ссылок на функции конструкторы контроллеров.
- **core** / 				`Ядро системы.`
	- **base** / 			`Базовыхй модуль. Может быть скопирован в app и переопределен`
		- **config** / 		`Конфигурация модуля`
		- **controller** / 	`Контроллеры модуля`
		- **i18n** / 		`Интернационализация модуля`
		- **model** / 		`Модели модуля`
		- **query** /		`Запросы к БД`
		- **server** / 		`Переопределения функционала веб сервера`
		- **service** / 	`Демоны, сервисы модуля`
		- **setup** / 		`Инициализация модуля, инсталяция`
	- **config** / 			`Глобальная конфигурация и инциализация приложения`
	- **i18n** / 			`Функционал интернационализации`
	- **model** / 			`Базовая модель`
	- **server** / 			`Веб сервер(а). Принимает и обрабатывает запросы. Отдает результат.`
- **lib**/ 					`Системные библиотеки.`
- **types**/ 				`Фунционал по работе с типами. копирование типов, Хранение и работа с сценариями типов.`
	- **config** /			`Типы глобальной конфигурации`
	- **db** /				`Типы проецирующие структуру БД`
	- **request** /			`Тип для формирование запросов`
	- **response** /		`Тип для формирование ответов`
	
сторонние библиотеки (кладутся в корень src проекта)
- github.com /...
- code.google.com /...
- bitbucket.org /...
- ...

### Документация кода программы.
В корневой папке проекта запустить: `godoc -http=:6060 -goroot=путь до папки проекта`

Запустится сервер доступный по ссылке: [http://lolcahost:6060](http://lolcahost:6060)

### Архитектура и логика работы приложения в целом


##### Запуск приложения
- Получение и инициализация параметров коммандной строки

	application [mode] [cfgFile]
	- mode: Режим запуска приложения:
		- install - Установка сервиса в операционной системе, используется в windows, mac os x
		- remove - Удаление сервиса из операционной системы
		- start - Запуск ранее установленного сервиса
		- stop - Остановка ранее установленного сервиса
		- run - Запуск в режиме разработки выход по 'Ctrl+C'
		- test - Тестирование работоспособности и выход
	- cfgFile: Полный путь до конфигурационного файла:


- Инициализация конфигурации приложения
	- Провизводится поиск конфигурационного файла.
	
		Начниая с папки запускного файла приложения.
		Более подробно смотрите программный код. `core/config/`
	- Найденная конфигурация читается и  инициализируется в объект конфигурации `core.Config`.
	
		Конфигурацию можно расширять путем добавление новых типов (секций) и их свойств (парамтеров секций).
		Поддерживаются скалярные типы `int..., uint..., string, float, bool`.
	- Создаются служебные папки.
	- Инициализируются системные библиотеки.
	- Производитеся прекомпилция (парсинг и занесения в хеши библиотек) нативных запросов к БД `moduleName/query/...`.
- Выбо режима запуска приложения
	В зависимости от параметра командной строки выбирается режим запуска приложения.
- Запуск службы логирования `lib/logs`
- Проверка и инициализация железа

	Возможное количество испозьуемых процессоров.
	Проверка доступной оперативной памяти.
- Создание блокирующего одновременный запуск нескольких програграм pid файла.
- Проверка БД если режим ее использования включен.
- Загрузка и инициализация данных приложения.
	
	- Загрузка данных из БД, если она используеться в область приложения `app.Data`.
	- Загрузка конфигурации контроллеров и роутинга разделов прописанных в модулях (setup модулей)
	- Синхронизация (сверка и регистрация) с БД конфигураций модулей.
	- Инициализация роутинга `app.Routes`
	- Проверка работаоспособности всех зарегистрированных контроллеров `app.Controller`.
- Запуск служб модулей приложения `src/modules.go`
	
	ModuleName1/service/...  
	ModuleName2/service/...
- Запуск сервера(ов)

		В файле `src/modules.go` подключаются используемые в приложении модули.  
		Таким образом утсановки модулей (контроллеры, роутинг, ...)  
		инстанцируются в приложение до его запуска!
			
##### Работа в штатном режиме
Ниже описан (поверхностно) алгоритм обратки запросов по умолчанию.

- Отдача статики если по запросу найден файл в ФС.
- Поиск и инициализация URI (раздела) (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)

	Обработка 301, 404
- Поиск и инициализация пользователя по токену (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Инициализация управления потоком I/O (rw)
- Инициализация сессии (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Проверка прав (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Работа контроллеров
- Вывод (как правило до этого шага доходит публичный html)
