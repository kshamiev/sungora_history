[Главная](/) ::
[Начало](/docs/start.html) ::
[Справочник](/docs/reference.html) ::
[Учебник](/docs/tutorial.html) ::
[Системное api](/docs/api.html) ::
[Скачать](https://github.com/kshamiev/sungora)

# Начало
***

### ФС рабочего приложения (www.domain.ru)
- **bin** / 				`Скопилированный (из исходников - src) исполняемый файл приложения.`
- **keys** / 				`различные ключи сертификации.`
- **log** / 				`Логи работы приложения.`
- **run** / 				`PID файлы процесса приложения.`
- **templates** /			`Шаблоны приложения (виды), статика.`
	- **localhost** / 		`Статика: css, javascript, img. Макеты (layout).`

        Папка для ведения разработок
	- **mail** / 			`Почтовые шаблоны.`
	- **view** / 			`Шаблоны контроллеров.`
	- **www.domain.ru** / 	`Статика: css, javascript, img. Макеты (layout).`

        Боевая папка проекта - конркетного домена (и его алиасов)
- **upload**/ 				`Папка загружаемых бинарных данных на сервер.`

***

### ФС разрабатываемого приложения (src)
- **app** / 				`Область приложения.`

	Модули приложения. Данные приложения.</br>
	Роутинг, Хеш ссылок на функции конструкторы контроллеров.
- **core** / 				`Ядро системы.`
	- **base** / 			`Базовыхй модуль. Может быть скопирован в app и переопределен`
		- **config** / 		`Конфигурация модуля`
		- **controller** / 	`Контроллеры модуля`
		- **i18n** / 		`Интернационализация модуля`
		- **model** / 		`Модели модуля`
		- **query** /		`Запросы к БД`
		- **server** / 		`Переопределения функционала веб сервера`
		- **service** / 	`Демоны, сервисы модуля`
		- **setup** / 		`Инициализация модуля, инсталяция`
	- **config** / 			`Глобальная конфигурация и инциализация приложения`
	- **i18n** / 			`Функционал интернационализации`
	- **model** / 			`Базовая модель`
	- **server** / 			`Веб сервер(а). Принимает и обрабатывает запросы. Отдает результат.`
- **lib**/ 					`Системные библиотеки.`
- **types**/ 				`Фунционал по работе с типами. копирование типов, Хранение и работа с сценариями типов.`
	- **config** /			`Типы глобальной конфигурации`
	- **db** /				`Типы проецирующие структуру БД`
	- **request** /			`Тип для формирование запросов`
	- **response** /		`Тип для формирование ответов`

сторонние библиотеки (кладутся в корень src проекта)
- github.com /...
- code.google.com /...
- bitbucket.org /...
- ...

***

### Файловая структура пакетов
Пакет формируется из файлов разбитых по функциональному признаку. Пример:
…/packagename/
- packagename.go

Основной файл пакета. Содержит основной функционал пакета. Возможно целиком состоит из одного такого файла.

- functionalname.go

Файл содержащий логически законченный программный код, реализующий конкретную прикладную задачу пакета.

- doc.go

Документация и примеры использования пакета.

Платформ зависимый программный код размещается в одноименных функциональных файлах с добавлением суффикса платформы (_windows, _darwin, _linux).
В каждом платформа зависимом файле обязательно должен находиться один и тот же набор функций или методов.
Также в пакете могут присутствовать файлы тестирования (_test)

Для исключения путаницы в одноименных файлах (контроллеров, моделей, типов):
- Файлы пакетов прикладных контроллеров заканчиваются заглавной буквой `C`
- Файлы пакетов прикладных моделей заканчиваются заглавной буквой `M`
- Файлы пакетов типов БД заканчиваются заглавной буквой `T`

***

### Архитектура и логика работы приложения в целом

##### Запуск приложения
- Получение и инициализация параметров коммандной строки

	$ application [mode] [cfgFile]
	- mode: Режим запуска приложения:
		- install - Установка сервиса в операционной системе, используется в windows, mac os x
		- remove - Удаление сервиса из операционной системы
		- start - Запуск ранее установленного сервиса
		- stop - Остановка ранее установленного сервиса
		- run - Запуск в режиме разработки выход по 'Ctrl+C'
		- test - Тестирование работоспособности и выход
	- cfgFile: Полный путь до конфигурационного файла:


- Инициализация конфигурации приложения
	- Провизводится поиск конфигурационного файла.

		Начниая с папки запускного файла приложения.
		Более подробно смотрите платформозависмый программный код. `core/config/`
	- Найденная конфигурация читается, проверяется и  инициализируется в объект конфигурации `core.Config`.

		Конфигурацию можно расширять путем добавление новых типов (секций) и их свойств (парамтеров секций).
		Поддерживаются скалярные типы `int..., uint..., string, float, bool`.
	- Создаются служебные папки.
	- Инициализируются системные библиотеки.
	- Производитеся прекомпилция (парсинг и занесения в хеши библиотек) нативных запросов к БД `moduleName/query/...`.
- Выбор режима запуска приложения
	В зависимости от параметра командной строки выбирается режим запуска приложения.
- Запуск службы логирования `lib/logs`
- Создание блокирующего одновременный запуск нескольких програм pid файла.
- Проверка и инициализация железа

	Возможное количество испозьуемых процессоров.
	Проверка доступной оперативной памяти.
- Проверка БД если режим ее использования включен.
- Загрузка и инициализация данных приложения.

	- Загрузка данных из БД, если она используеться в область приложения `app.Data`.
	- Загрузка конфигурации контроллеров и роутинга разделов прописанных в модулях (setup модулей)
	- Синхронизация (сверка и регистрация) с БД конфигураций модулей.
	- Инициализация роутинга `app.Routes`
	- Проверка работаоспособности всех зарегистрированных контроллеров `app.Controller`.
- Запуск служб модулей приложения `src/modules.go`

	ModuleName1/service/...
	ModuleName2/service/...
- Запуск сервера(ов)

		В файле `src/modules.go` подключаются используемые в приложении модули (moduleName/setup), имеющие функции init()
		Таким образом утсановки модулей (контроллеры, роутинг, ...)
		инстанцируются в приложение до его запуска!

##### Работа в штатном режиме
Ниже описан (поверхностно) алгоритм обратки запросов по умолчанию.

- Инициализация управления потоком I/O (rw)
- Отдача статики если по запросу найден файл в ФС.
- Поиск и инициализация URI (раздела) (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Поиск и инициализация пользователя по токену (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Инициализация сессии (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Проверка прав доступа (ОПРЕДЕЛЯЕТСЯ МОДУЛЕМ)
- Работа контроллеров
- Вывод (как правило до этого шага доходит публичный html)

***

### Документация кода программы.
В корневой папке проекта запустить: `godoc -http=:6060 -goroot=путь до папки проекта`

Запустится сервер доступный по ссылке: [http://lolcahost:6060](http://lolcahost:6060)

***

### Принятая нумерация версий

X.X.X или R.A.B

- R (Release) - Первая цифра обозначает номер релиза. Итерация этого порядка привязывается к завершению этапа разработок и выкатыванию. Как правило, это происходит при разработке каких-либо новых функциональных возможностей (модулей) или фундаментальных изменений самой системы. Или когда их количество и качество становится слишком большим.

- A (Advanced) – Вторая цифра обозначает номер дополнения к релизу. Итерация этого порядка происходит при разработке нового или доработке и расширении ранее реализованного функционала. Эта цифра обнуляется во время итерации первой цифры R (при выкатывании нового релиза).

- B (Bugfix) – Третья цифра обозначает номер исправленной ошибки в работающем проекте. Итерация этого порядка происходит при исправлении выявленных ошибок в уже работающем проекте. Эта цифра обнуляется во время итерации первой цифры R (при выкатывании нового релиза).
